{"version":3,"sources":["../source/GitHubSDK.js"],"names":["PACKAGE","require","GitHubSDK","token","undefined","Error","message","key","urls","api","search_users","users","headers","Authorization","Accept","userAgent","version","name","org","description","homepage","trim","length","options","method","body","JSON","stringify","url","response","json","ok","status","statusText","keywordsList","keywords","Array","isArray","promises","map","keyword","searchForUser","Promise","all","encodeURIComponent","user","items","userLogin","login","blog","email","avatar_url","gravatar_id","company","fail"],"mappings":"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","file":"GitHubSDK.js","sourcesContent":["import 'babel-polyfill';\nimport fetch from 'isomorphic-fetch';\nimport ErrorServerResponse from './ErrorServerResponse';\n\nconst PACKAGE = require('../package.json');\n\n/**\n * SDK for mercury api\n *\n * @namespace GitHubSDK\n * @class\n * @param {string} token - github app token\n * @see https://developer.github.com/v3/\n */\nexport default class GitHubSDK {\n  /**\n   * Constructor, save mercury api key\n   * @param {string} token - github app token\n   */\n  constructor(token) {\n\n    if (token === undefined) throw new Error(GitHubSDK.message.key);\n\n    this.urls = {\n      api: 'https://api.github.com/',\n      search_users: 'search/users',\n      users: 'users/',\n    };\n\n    this.headers = {\n      Authorization: `token ${ token }`,\n      Accept: 'application/vnd.github.v3+json',\n      userAgent: `UserCrowler/${ PACKAGE.version }`,\n      'Content-Type': 'application/json',\n    };\n  }\n\n  /**\n   * Messages of mercury SDK\n   * @namespace GitHubSDK\n   * @type {Object}\n   */\n  static message = {\n    key: 'You need to pass your app token',\n    fail: 'Failed fetching page',\n    org: 'Organization name missing in the arguments list',\n    name: 'Repository name missing in the arguments list',\n  };\n\n  /**\n   * Create repository in the organization\n   * @namespace GitHubSDK\n   *\n   * @param  {string}  name                  Repository name\n   * @param  {string}  [description=null]     Repository description\n   * @param  {string}  [homepage=null]       Link to some related resourse\n   * @param  {string}  [org=this.config.org] Organization name\n   * @return {Promise<Repository>}           Repository object\n   */\n  async create({\n    name,\n    org,\n    description = null,\n    homepage = null,\n  }) {\n\n    if (typeof name !== 'string' || name.trim().length === 0) throw new Error(GitHubSDK.message.name);\n    if (typeof org !== 'string' || org.trim().length === 0) throw new Error(GitHubSDK.message.org);\n\n    const options = {\n      method: 'POST',\n      headers: this.headers,\n      body: JSON.stringify({\n        name,\n        description,\n        homepage,\n      }),\n    };\n\n    const url = `${this.urls.api}orgs/${org}/repos`;\n    const response = await fetch(url, options);\n    const json = await response.json();\n    if (!response.ok) {\n      throw new ErrorServerResponse(response.status, response.statusText, json);\n    }\n    return json;\n  }\n\n  /**\n   * Repository object\n   *\n   * @namespace GitHubSDK\n   * @typedef {Repository} Repository representation\n   * @see https://developer.github.com/v3/repos/#response-2\n   */\n\n  /**\n   * Search for users\n   * @namespace GitHubSDK\n   *\n   * @param {Array} keywords\n   * @return {Promise}\n   */\n  searchForUsers(keywordsList) {\n    const keywords = (!Array.isArray(keywordsList) && typeof keywordsList === 'string') ? new Array(keywordsList) : keywordsList;\n    const promises = keywords.map((keyword)=>this.searchForUser(keyword));\n    return Promise.all(promises);\n  }\n\n\n  /**\n   * Search for users\n   * @namespace GitHubSDK\n   *\n   * @param {Array} keywords\n   * @return {Promise}\n   */\n  searchForUsers(keywordsList) {\n    const keywords = (!Array.isArray(keywordsList) && typeof keywordsList === 'string') ? new Array(keywordsList) : keywordsList;\n    const promises = keywords.map((keyword)=>this.searchForUser(keyword));\n    return Promise.all(promises);\n  }\n\n  /**\n   * Search for user\n   * @namespace GitHubSDK\n   *\n   * @param {String} keyword\n   * @return {Promise}\n   */\n  async searchForUser(keyword) {\n    const options = {\n      method: 'GET',\n      headers: this.headers,\n    };\n    const response = await fetch(`${this.urls.api + this.urls.search_users  }?q=${encodeURIComponent(keyword)}`, options);\n    if (response.ok) {\n      const user = await response.json();\n      return user.items;\n    }\n    throw new Error(`${response.status} ${response.statusText}`);\n  }\n\n  /**\n   * Get user information\n   * @namespace GitHubSDK\n   *\n   * @param {String} login\n   * @return {Promise}\n   */\n  async getUser(userLogin) {\n    const options = {\n      method: 'GET',\n      headers: this.headers,\n    };\n    const url = `${this.urls.api}${this.urls.users}${encodeURIComponent(userLogin)}`;\n    const response = await fetch(url, options);\n    if (!response.ok) throw new Error(`${response.status} ${response.statusText}`);\n    const json = await response.json();\n    const { login, blog, name, email, avatar_url, gravatar_id, company } = json;\n    return { login, blog, name, email, avatar_url, gravatar_id, company };\n  }\n\n}\n"]}